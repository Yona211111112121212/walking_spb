name: Simple CI Test

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Show Project Structure
      run: |
        echo "Project structure:"
        find . -type f -name "*.js" -o -name "*.json" -o -name "package.json" | head -20
        echo "Backet directory contents:"
        ls -la Backet/ 2>/dev/null || echo "No Backet directory"
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
    
    - name: Check Backend Files
      run: |
        echo "Checking backend files..."
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
        if [ ! -d "Backet" ]; then
          echo "‚ùå Backet directory not found!"
          exit 1
        fi
        
        cd Backet
        
        if [ ! -f "package.json" ]; then
          echo "‚ùå package.json not found in Backet!"
          exit 1
        fi
        
        if [ ! -f "server.js" ]; then
          echo "‚ùå server.js not found in Backet!"
          exit 1
        fi
        
        echo "‚úÖ Essential backend files found"
        npm install --no-audit
        echo "‚úÖ Dependencies installed"
        
        # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
        node -c server.js && echo "‚úÖ server.js syntax is valid"
        if [ -f "database.js" ]; then
          node -c database.js && echo "‚úÖ database.js syntax is valid"
        fi
    
    - name: Check Frontend Files
      run: |
        if [ -d "frontend" ]; then
          echo "Checking frontend files..."
          cd frontend
          
          if [ -f "package.json" ]; then
            echo "‚úÖ Frontend package.json found"
            npm install --no-audit
            echo "‚úÖ Frontend dependencies installed"
            
            if [ -f "src/App.js" ]; then
              node -c src/App.js && echo "‚úÖ App.js syntax is valid"
            fi
          fi
        else
          echo "‚ÑπÔ∏è Frontend directory not found, skipping"
        fi
    
    - name: Success Message
      run: |
        echo "üéâ CI Pipeline completed successfully!"
        echo "All basic checks passed."